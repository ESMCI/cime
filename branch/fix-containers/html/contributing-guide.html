

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contributing Guide &mdash; CIME master documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx-toolbox-code.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=3d7e66fe" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=30d551ce"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="Glossary" href="glossary.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CIME
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">For Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ccs/index.html">Case Control System (CCS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="system_testing.html">System Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers/Contributors</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contributing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-the-tests">Running the tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#unit-testing">Unit Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-testing">System Testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#code-quality">Code Quality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-pre-commit">Installing pre-commit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-pre-commit">Running pre-commit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-git-hook-scripts">Installing git hook scripts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#docker-container">Docker container</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running">Running</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#environment-variables">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building">Building</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CIME</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Contributing Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/contributing-guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="contributing-guide">
<span id="id1"></span><h1>Contributing Guide<a class="headerlink" href="#contributing-guide" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#testing" id="id3">Testing</a></p>
<ul>
<li><p><a class="reference internal" href="#running-the-tests" id="id4">Running the tests</a></p>
<ul>
<li><p><a class="reference internal" href="#unit-testing" id="id5">Unit Testing</a></p></li>
<li><p><a class="reference internal" href="#system-testing" id="id6">System Testing</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#code-quality" id="id7">Code Quality</a></p>
<ul>
<li><p><a class="reference internal" href="#installing-pre-commit" id="id8">Installing pre-commit</a></p></li>
<li><p><a class="reference internal" href="#running-pre-commit" id="id9">Running pre-commit</a></p></li>
<li><p><a class="reference internal" href="#installing-git-hook-scripts" id="id10">Installing git hook scripts</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#docker-container" id="id11">Docker container</a></p>
<ul>
<li><p><a class="reference internal" href="#running" id="id12">Running</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables" id="id13">Environment variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building" id="id14">Building</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>The Community Earth System Model (CIME) is a powerful, community-driven framework designed to support the development, configuration, and execution of Earth system models. As an open-source project, CIME thrives on the contributions of researchers, developers, and users worldwide. Whether you’re fixing a bug, adding new features, improving documentation, or sharing your expertise, your involvement helps advance the scientific community’s ability to understand and simulate Earth’s complex systems. This guide provides everything you need to get started—from setting up your development environment to submitting your first pull request—so you can contribute with confidence and join a vibrant community dedicated to scientific collaboration and innovation.</p>
<p>To get started, you can contribute by fixing issues or answering questions in the community forums. If you’re ready to dive deeper and contribute code, consider exploring these key areas:</p>
<ul class="simple">
<li><p>The Case class, which is central to the CIME Configuration System (CCS);</p></li>
<li><p>XML classes, which form the backbone of CCS configuration;</p></li>
<li><p>SystemsTest, used to test models under specific conditions.</p></li>
</ul>
<p><strong>As you add features or bug fixes, remember the importance of adding unit tests.</strong></p>
<p>Unit tests help ensure that each new change works as intended and doesn’t break existing functionality. By isolating and verifying small units of code, you catch bugs early, reduce the risk of regressions, and make your codebase more maintainable. Unit tests also act as living documentation, clarifying expected behavior for future developers and enabling safer refactoring. Investing in unit tests saves time, improves code quality, and builds confidence in your software’s reliability.</p>
</section>
<section id="testing">
<span id="contributing-guide-running-tests"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Testing</a><a class="headerlink" href="#testing" title="Link to this heading"></a></h2>
<p>CIME splits it’s testing into two categories <cite>unit</cite> and <cite>sys</cite>.</p>
<ul class="simple">
<li><p>The <cite>unit</cite> category covers both doctests and unit tests.</p></li>
<li><p>The <cite>sys</cite> category covers regression tests.</p></li>
</ul>
<p>The tests are named accordingly e.g. <cite>unit</cite> tests are found as <cite>CIME/tests/test_unit*</cite>.</p>
<section id="running-the-tests">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Running the tests</a><a class="headerlink" href="#running-the-tests" title="Link to this heading"></a></h3>
<p>There are two possible methods to run these tests; <code class="docutils literal notranslate"><span class="pre">pytest</span></code> and <code class="docutils literal notranslate"><span class="pre">scripts_regression_tests</span></code>.</p>
<p>To run the tests with <code class="docutils literal notranslate"><span class="pre">pytest</span></code> you’ll need to install some packages; <code class="docutils literal notranslate"><span class="pre">pytest</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest-cov</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The scripts_regression_tests.py will be deprecated and the preferred method of running tests it <code class="docutils literal notranslate"><span class="pre">pytest</span></code>.</p>
</div>
<section id="unit-testing">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">Unit Testing</a><a class="headerlink" href="#unit-testing" title="Link to this heading"></a></h4>
<p>Here’s an example for running the unit tests using both methods.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>CIME/tests/test_unit*
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>CIME/tests/scripts_regression_tests.py<span class="w"> </span>CIME/tests/test_unit*
</pre></div>
</div>
</section>
<section id="system-testing">
<h4><a class="toc-backref" href="#id6" role="doc-backlink">System Testing</a><a class="headerlink" href="#system-testing" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>CIME/tests/test_sys*
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>CIME/tests/scripts_regression_tests.py<span class="w"> </span>CIME/tests/test_sys*
</pre></div>
</div>
</section>
</section>
</section>
<section id="code-quality">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Code Quality</a><a class="headerlink" href="#code-quality" title="Link to this heading"></a></h2>
<p><strong>To maintain high code quality and consistency, all code must be linted with Pylint and formatted using Black.</strong> We also use additional tools to enforce proper XML formatting, ensure files end with newlines, and eliminate trailing whitespace.</p>
<p><strong>To streamline these checks, we require the use of pre-commit.</strong> While our GitHub Actions will automatically lint and check the format of every pull request, they will not fix issues for you—developers are responsible for resolving any linting or formatting errors.</p>
<p><strong>We strongly recommend installing pre-commit’s Git hooks</strong> to run these checks automatically before each commit, helping you catch and fix issues early.</p>
<section id="installing-pre-commit">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Installing pre-commit</a><a class="headerlink" href="#installing-pre-commit" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pre_commit
<span class="c1"># or</span>
<span class="c1"># conda install -c conda-forge pre_commit</span>
</pre></div>
</div>
</section>
<section id="running-pre-commit">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Running pre-commit</a><a class="headerlink" href="#running-pre-commit" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>run<span class="w"> </span>-a
</pre></div>
</div>
</section>
<section id="installing-git-hook-scripts">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Installing git hook scripts</a><a class="headerlink" href="#installing-git-hook-scripts" title="Link to this heading"></a></h3>
<p>If you install these scripts then <cite>pre-commit</cite> will automatically run on <cite>git commit</cite>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit<span class="w"> </span>install
</pre></div>
</div>
</section>
</section>
<section id="docker-container">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Docker container</a><a class="headerlink" href="#docker-container" title="Link to this heading"></a></h2>
<p>CIME provides a container that is utilized by CI testing and provides developers with a consistent environment they can test in.</p>
<p>This container provides a <code class="docutils literal notranslate"><span class="pre">GNU</span></code> compiler, <code class="docutils literal notranslate"><span class="pre">OpenMPI</span></code> library and all confguration required to run CIME’s testing and build simple test cases. The compiler and libraries in the container is managed using <code class="docutils literal notranslate"><span class="pre">Anaconda</span></code>. There are currently two preloaded environments; <code class="docutils literal notranslate"><span class="pre">e3sm</span></code> and <code class="docutils literal notranslate"><span class="pre">cesm</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since CIME is generally provided as a sub-module in a projects repostiory the CIME containers do not provide either the project or CIME code. You’ll need to pass these through using a volume.</p>
</div>
<p>The provide machine configuration requires you to either set the containers hostname with <code class="docutils literal notranslate"><span class="pre">--hostname</span> <span class="pre">docker</span></code> or pass <code class="docutils literal notranslate"><span class="pre">--machine</span> <span class="pre">docker</span></code> to all CIME tooling.</p>
<p>It’s usually recommended to use the <code class="docutils literal notranslate"><span class="pre">latest</span></code> tag but if an older version is required you can find these at <a class="reference external" href="https://github.com/ESMCI/cime/pkgs/container/cime">https://github.com/ESMCI/cime/pkgs/container/cime</a>.</p>
<section id="running">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Running</a><a class="headerlink" href="#running" title="Link to this heading"></a></h3>
<p>The following assumes you’ve checkouted out your projects code to <code class="docutils literal notranslate"><span class="pre">$HOME/model</span></code> and the name of your model is stored in <code class="docutils literal notranslate"><span class="pre">$TARGET_MODEL</span></code> environment variable.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--hostname<span class="w"> </span>docker<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/model&quot;</span>:/home/cime/model<span class="w"> </span>-e<span class="w"> </span><span class="nv">USER_ID</span><span class="o">=</span><span class="sb">`</span>id<span class="w"> </span>-u<span class="sb">`</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">GROUP_ID</span><span class="o">=</span><span class="sb">`</span>id<span class="w"> </span>-g<span class="sb">`</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">CIME_MODEL</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$TARGET_MODEL</span><span class="s2">&quot;</span><span class="w"> </span>ghcr.io/esmci/cime:latest<span class="w"> </span>bash
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">USER_ID=`id</span> <span class="pre">-u`</span> <span class="pre">-e</span> <span class="pre">GROUP_ID=`id-</span> <span class="pre">g`</span></code> is required so the containers uid/gid will match your host machines. This allows the containers user to have the correct permissions to view/edit files and if any new files are created you can access them outside the container.</p>
</div>
<p>While running CIME within the continer there may be a need to persist either the inputdata retrieved by CIME or the cases that are created. This can be accomplished using volumes. The following example assumes inputdata will be stored at <code class="docutils literal notranslate"><span class="pre">$HOME/CIME/inputdata</span></code> and cases at <code class="docutils literal notranslate"><span class="pre">$HOME/CIME/cases</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--hostname<span class="w"> </span>docker<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/model&quot;</span>:/home/cime/model<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/CIME/inputdata&quot;</span>:/home/cime/inputdata<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/CIME/cases&quot;</span>:/home/cime/cases<span class="w"> </span>-e<span class="w"> </span><span class="nv">USER_ID</span><span class="o">=</span><span class="sb">`</span>id<span class="w"> </span>-u<span class="sb">`</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">GROUP_ID</span><span class="o">=</span><span class="sb">`</span>id<span class="w"> </span>-g<span class="sb">`</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">CIME_MODEL</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$TARGET_MODEL</span><span class="s2">&quot;</span><span class="w"> </span>ghcr.io/esmci/cime:latest<span class="w"> </span>bash
</pre></div>
</div>
<section id="environment-variables">
<h4><a class="toc-backref" href="#id13" role="doc-backlink">Environment variables</a><a class="headerlink" href="#environment-variables" title="Link to this heading"></a></h4>
<p>The following environment variables control some aspects of the cotnainers behavior.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USER_ID</p></td>
<td><p>Sets the container’s user id.</p></td>
<td><p>1000</p></td>
</tr>
<tr class="row-odd"><td><p>GROUP_ID</p></td>
<td><p>Sets the container’s group id.</p></td>
<td><p>1000</p></td>
</tr>
<tr class="row-even"><td><p>SKIP_ENTRYPOINT</p></td>
<td><p>Skips entering a new shell as the
container’s user.</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="building">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Building</a><a class="headerlink" href="#building" title="Link to this heading"></a></h3>
<p>The container provides 3 targets.</p>
<ul class="simple">
<li><p>base - Base image with no batch system.</p></li>
<li><p>slurm - Slurm batch system with configuration and single queue.</p></li>
<li><p>pbs - PBS batch system with configuration and single queue.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>ghcr.io/ESMCI/cime:latest<span class="w"> </span>--target<span class="w"> </span>&lt;target&gt;<span class="w"> </span>docker/
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="glossary.html" class="btn btn-neutral float-left" title="Glossary" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, U.S. National Science Foundation and U.S. Department of Energy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
     
<script>var version_json_loc = "../../versions.json";</script>


</footer>
        </div>
      </div>
    </section>
  </div>
  

  <script type="text/javascript">
    let baseUriRegex = /(.*\/cime)\/.*/g;
    let parsedUri = baseUriRegex.exec(document.baseURI);

    if (parsedUri != null && parsedUri.length == 2) {
      let baseUri = parsedUri[1];

      $.get(`${baseUri}/versions/versions.json`, function(data) {
        let versionElement = $("#versions");

        Object.keys(data).forEach(function(key) {
          let value = data[key];

          let item = `<dd><a href="${baseUri}/versions/${key}/html/">${value}</a></dd>`

          versionElement.append(item);
        });
      });
    }
  </script>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: master
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl id="versions">
        <dt>Versions</dt>
      </dl>
      
      
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>