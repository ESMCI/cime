

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. Model grids &mdash; CIME master documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=30d551ce"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Defining the machine" href="machine.html" />
    <link rel="prev" title="3. Component sets" href="compsets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CIME
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../what_cime/index.html">What is CIME?</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Using the Case Control System</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#configuring-the-case-control-system">Configuring the Case Control System</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cime-internals.html">1. Main Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">2. Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="compsets.html">3. Component sets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4. Model grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#grid-longname">4.1. Grid longname</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-grids">4.2. Adding grids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="machine.html">5. Defining the machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="pes-threads.html">6. Controlling processors and threads</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting-cime.html">7. Porting and validating CIME on a new platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing.html">8. Fortran Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi-instance.html">9. Multi-instance component functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html">10. Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="cime-dir.html">11. Directory content</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../build_cpl/index.html">Building a Coupled Model with CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_tools/index.html">Miscellaneous Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary/index.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_user/index.html">User Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xml_files/index.html">XML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CIME_api/modules.html">CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_api/modules.html">Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CIME</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Using the Case Control System</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span>Model grids</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/users_guide/grids.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-grids">
<span id="grids"></span><h1><span class="section-number">4. </span>Model grids<a class="headerlink" href="#model-grids" title="Link to this heading"></a></h1>
<p>CIME looks at the xml node <code class="docutils literal notranslate"><span class="pre">GRIDS_SPEC_FILE</span></code> in  <strong>$CIMEROOT/config/$models/config_files.xml</strong> file to identify supported out-of-the-box model grids for the target model.</p>
<p>The node has the following contents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;entry id=&quot;GRIDS_SPEC_FILE&quot;&gt;
  &lt;type&gt;char&lt;/type&gt;
  &lt;default_value&gt;$CIMEROOT/cime_config/$MODEL/config_grids.xml&lt;/default_value&gt;
  &lt;group&gt;case_last&lt;/group&gt;
  &lt;file&gt;env_case.xml&lt;/file&gt;
  &lt;desc&gt;file containing specification of all supported model grids, domains and mapping files (for documentation only - DO NOT EDIT)&lt;/desc&gt;
  &lt;schema&gt;$CIMEROOT/cime_config/xml_schemas/config_grids_v2.xsd&lt;/schema&gt;
&lt;/entry&gt;
</pre></div>
</div>
<section id="grid-longname">
<h2><span class="section-number">4.1. </span>Grid longname<a class="headerlink" href="#grid-longname" title="Link to this heading"></a></h2>
<p>CIME model grids generally are associated with a specific combination of atmosphere, land, land-ice, river-runoff and ocean/ice grids. The naming convention for these grids uses only atmosphere, land, and ocean/ice grid specifications.</p>
<p>A model grid longname has the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">%</span><span class="n">name_l</span><span class="o">%</span><span class="n">name_oi</span><span class="o">%</span><span class="n">name_r</span><span class="o">%</span><span class="n">name_m</span><span class="o">%</span><span class="n">mask_g</span><span class="o">%</span><span class="n">name_w</span><span class="o">%</span><span class="n">name</span>
</pre></div>
</div>
<p>For reference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">%</span>  <span class="o">=</span> <span class="n">atmosphere</span> <span class="n">grid</span>
<span class="n">l</span><span class="o">%</span>  <span class="o">=</span> <span class="n">land</span> <span class="n">grid</span>
<span class="n">oi</span><span class="o">%</span> <span class="o">=</span> <span class="n">ocean</span><span class="o">/</span><span class="n">sea</span><span class="o">-</span><span class="n">ice</span> <span class="n">grid</span> <span class="p">(</span><span class="n">must</span> <span class="n">be</span> <span class="n">the</span> <span class="n">same</span><span class="p">)</span>
<span class="n">r</span><span class="o">%</span>  <span class="o">=</span> <span class="n">river</span> <span class="n">grid</span>
<span class="n">m</span><span class="o">%</span>  <span class="o">=</span> <span class="n">ocean</span> <span class="n">mask</span> <span class="n">grid</span>
<span class="n">g</span><span class="o">%</span>  <span class="o">=</span> <span class="n">internal</span> <span class="n">land</span><span class="o">-</span><span class="n">ice</span> <span class="n">grid</span>
<span class="n">w</span><span class="o">%</span>  <span class="o">=</span> <span class="n">wave</span> <span class="n">component</span> <span class="n">grid</span>
</pre></div>
</div>
<p>The ocean mask grid determines land/ocean boundaries in the model.
On the ocean grid, a grid cell is assumed to be either all ocean or all land.
The land mask on the land grid is obtained by mapping the ocean mask
(using first-order conservative mapping) from the ocean grid to the land grid.</p>
<p>From the point of view of model coupling, the glc grid is assumed to
be identical to the land grid. The internal land-ice grid can be different,
however, and is specified by the g% value.</p>
<p>As an example, examine this actual grid longname:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">%</span><span class="n">ne30np4_l</span><span class="o">%</span><span class="n">ne30np4_oi</span><span class="o">%</span><span class="n">gx1v7_r</span><span class="o">%</span><span class="n">r05_m</span><span class="o">%</span><span class="n">gx1v7_g</span><span class="o">%</span><span class="n">null_w</span><span class="o">%</span><span class="n">null</span>
</pre></div>
</div>
<p>It refers to a model grid with a ne30np4 spectral element (approximately 1-degree) atmosphere and land grids, gx1v7 Greenland pole, 1-degree ocean and sea-ice grids, a 1/2 degree river routing grid, null wave and internal cism grids, and an gx1v7 ocean mask.
The alias for this grid is ne30_g16.</p>
<p>CIME also permits users to introduce their own <a class="reference internal" href="#adding-a-grid"><span class="std std-ref">user-defined grids</span></a>.</p>
<p>Component grids are denoted by the following naming convention:</p>
<ul class="simple">
<li><p>“[dlat]x[dlon]” are regular lon/lat finite volume grids where dlat and dlon are the approximate grid spacing. The shorthand convention is “fnn” where nn generally is a pair of numbers indicating the resolution. An example is 1.9x2.5 or f19 for the approximately “2-degree” finite-volume grid. Note that CAM uses an [nlat]x[nlon] naming convention internally for this grid.</p></li>
<li><p>“Tnn” are spectral lon/lat grids where nn is the spectral truncation value for the resolution. The shorthand name is identical. Example: T85.</p></li>
<li><p>“ne[X]np[Y]” are cubed sphere resolutions where X and Y are integers. The short name generally is ne[X]. Examples: ne30np4 or ne30.</p></li>
<li><p>“pt1” is a single grid point.</p></li>
<li><p>“gx[D]v[n]” is a POP displaced pole grid where D is the approximate resolution in degrees and n is the grid version. The short name generally is g[D][n]. An example is gx1v7 or g17 for a grid of approximately 1-degree resolution.</p></li>
<li><p>“tx[D]v[n]” is a POP tripole grid where D is the approximate resolution in degrees and n is the grid version.</p></li>
<li><p>“oRSS[x]to[y]” is an MPAS grid with grid spacing from x to y kilometers.</p></li>
<li><p>“oEC[x]to[y]” is an MPAS grid with grid spacing from x to y kilometers.</p></li>
</ul>
</section>
<section id="adding-grids">
<span id="adding-cases"></span><h2><span class="section-number">4.2. </span>Adding grids<a class="headerlink" href="#adding-grids" title="Link to this heading"></a></h2>
<dl id="adding-a-grid">
<dt>CIME supports numerous out-of-the box model resolutions. To see the grids that are supported, call <a class="reference external" href="../Tools_user/query_config.html">query_config</a> as shown below.</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">query_config</span> <span class="o">--</span><span class="n">grids</span>
</pre></div>
</div>
</dd>
</dl>
<p>The most common resolutions have the atmosphere and land components on one grid and the ocean and ice on a second grid. The following overview assumes that this is the case.
The naming convention looks like <em>f19_g17</em>, where the f19 indicates that the atmosphere and land are on the 1.9x2.5 (finite volume dycore) grid while the g17 means the ocean and ice are on the gx1v6 one-degree displaced pole grid.</p>
<p>CIME enables users to add their own component grid combinations.
The steps for adding a new component grid to the model system follow. This process can be simplified if the atmosphere and land are running on the same grid.</p>
<ol class="arabic">
<li><p>The first step is to generate SCRIP grid files for the atmosphere, land, ocean, land-ice, river and wave component grids that will comprise your model grid.
If you are introducing just one new grid, you can leverage SCRIP grid files that are already in place for the other components.
There is no supported functionality for creating the SCRIP format file.</p></li>
<li><p>Build the <strong>check_map</strong> utility by following the instructions in <strong>$CIMEROOT/tools/mapping/check_maps/INSTALL</strong>. Also confirm that the ESMF toolkit is installed on your machine.</p>
<p>When you add new user-defined grid files, you also need to generate a set of mapping files so the coupler can send data from a component on one grid to a component on another grid.
There is an ESMF tool that tests the mapping file by comparing a mapping of a smooth function to its true value on the destination grid.
We have tweaked this utility to test a suite of smooth functions, as well as ensure conservation (when the map is conservative).
Before generating mapping functions it is <em>highly recommended</em> that you build this utility.</p>
</li>
<li><p>Generate these mapping files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atm</span> <span class="o">&lt;-&gt;</span> <span class="n">ocn</span>
<span class="n">atm</span> <span class="o">&lt;-&gt;</span> <span class="n">wav</span>
<span class="n">lnd</span> <span class="o">&lt;-&gt;</span> <span class="n">rof</span>
<span class="n">lnd</span> <span class="o">&lt;-&gt;</span> <span class="n">glc</span>
<span class="n">ocn</span> <span class="o">&lt;-&gt;</span> <span class="n">wav</span>
<span class="n">rof</span> <span class="o">-&gt;</span> <span class="n">ocn</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>Using the SCRIP grid files from Step 1, generate a set of conservative (area-averaged) and non-conservative (patch and bilinear) mapping files.</p>
<p>You can do this by calling <strong>gen_cesm_maps.sh</strong> in <code class="docutils literal notranslate"><span class="pre">$CIMEROOT/tools/mapping/gen_mapping_files/</span></code>.
This script generates all the mapping files needed except <code class="docutils literal notranslate"><span class="pre">rof</span> <span class="pre">-&gt;</span> <span class="pre">ocn</span></code>, which is discussed below.
This script uses the ESMF offline weight generation utility, which you must build <em>prior</em> to running <strong>gen_cesm_maps.sh</strong>.</p>
<dl>
<dt>The <strong>README</strong> file in the <strong>gen_mapping_files/</strong> directory describes how to run <strong>gen_cesm_maps.sh</strong>. The basic usage is shown here:</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd $CIMEROOT/tools/mapping/gen_mapping_files
&gt; ./gen_cesm_maps.sh \
   --fileocn  &lt;input SCRIP ocn_grid full pathname&gt;  \
   --fileatm  &lt;input SCRIP atm grid full pathname&gt;  \
   --filelnd  &lt;input SCRIP lnd grid full pathname&gt;  \
   --filertm  &lt;input SCRIP rtm grid full pathname&gt;  \
   --nameocn  &lt;ocnname in output mapping file&gt; \
   --nameatm  &lt;atmname in output mapping file&gt; \
   --namelnd  &lt;lndname in output mapping file&gt; \
   --namertm  &lt;rtmname in output mapping file&gt;
</pre></div>
</div>
</dd>
<dt>This command generates the following mapping files:</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">map_atmname_TO_ocnname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_atmname_TO_ocnname_blin</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_atmname_TO_ocnname_patc</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_ocnname_TO_atmname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_ocnname_TO_atmname_blin</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_atmname_TO_lndname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_atmname_TO_lndname_blin</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_lndname_TO_atmname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_ocnname_TO_lndname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_lndname_TO_rtmname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">map_rtmname_TO_lndname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You do not need to specify all four grids. For example, if you are running with the atmosphere and land on the same grid, then you do not need to specify the land grid (and atm&lt;-&gt;rtm maps will be generated).
If you also omit the runoff grid, then only the 5 atm&lt;-&gt;ocn maps will be generated.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ESMF_RegridWeightGen runs in parallel, and the <code class="docutils literal notranslate"><span class="pre">gen_cesm_maps.sh</span></code> script has been written to run on yellowstone.
To run on any other machine, you may need to add some environment variables to <code class="docutils literal notranslate"><span class="pre">$CIMEROOT/tools/mapping/gen_mapping_files/gen_ESMF_mapping_file/create_ESMF_map.sh</span></code> – search for hostname to see where to edit the file.</p>
</div>
</dd>
</dl>
</div></blockquote>
<ol class="arabic" start="4">
<li><p>Generate atmosphere, land and ocean / ice domain files.</p>
<p>Using the conservative ocean to land and ocean to atmosphere mapping files created in the previous step, you can create domain files for the atmosphere, land, and ocean; these are basically grid files with consistent masks and fractions.
You make these files by calling <strong>gen_domain</strong> in <strong>$CIMEROOT/tools/mapping/gen_domain_files</strong>.
The <strong>INSTALL</strong> file in the <strong>gen_domain_files/</strong> directory describes how to build the <strong>gen_domain</strong> executable. The <strong>README</strong> file in the same directory explains how to use the tool. The basic usage is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="o">./</span><span class="n">gen_domain</span> <span class="o">-</span><span class="n">m</span> <span class="o">../</span><span class="n">gen_mapping_files</span><span class="o">/</span><span class="n">map_ocnname_TO_lndname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">o</span> <span class="n">ocnname</span> <span class="o">-</span><span class="n">l</span> <span class="n">lndname</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">gen_domain</span> <span class="o">-</span><span class="n">m</span> <span class="o">../</span><span class="n">gen_mapping_files</span><span class="o">/</span><span class="n">map_ocnname_TO_atmname_aave</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">o</span> <span class="n">ocnname</span> <span class="o">-</span><span class="n">l</span> <span class="n">atmname</span>
</pre></div>
</div>
<p>These commands generate the following domain files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">domain</span><span class="o">.</span><span class="n">lnd</span><span class="o">.</span><span class="n">lndname_ocnname</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">domain</span><span class="o">.</span><span class="n">ocn</span><span class="o">.</span><span class="n">lndname_ocnname</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">domain</span><span class="o">.</span><span class="n">lnd</span><span class="o">.</span><span class="n">atmname_ocnname</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">domain</span><span class="o">.</span><span class="n">ocn</span><span class="o">.</span><span class="n">atmname_ocnname</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
<span class="n">domain</span><span class="o">.</span><span class="n">ocn</span><span class="o">.</span><span class="n">ocnname</span><span class="o">.</span><span class="n">yymmdd</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input atmosphere grid is assumed to be unmasked (global). Land cells whose fraction is zero will have land mask = 0.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the ocean and land grids <em>are identical</em> then the mapping file will simply be unity and the land fraction will be one minus the ocean fraction.</p>
</div>
</li>
<li><p>If you are adding a new ocn or rtm grid, create a new rtm-&gt;ocn mapping file. (Otherwise you can skip this step.)
The process for mapping from the runoff grid to the ocean grid is currently undergoing many changes.
At this time, if you are running with a new ocean or runoff grid, please contact Michael Levy (mlevy_AT_ucar_DOT_edu) for assistance. If you are running with standard ocean and runoff grids, the mapping file should already exist and you do not need to generate it.</p></li>
<li><p>CESM specific: If you are adding a new atmosphere grid, this means you are also generating a new land grid, and you will need to create a new CLM surface dataset. (Otherwise you can skip this step).
You need to first generate mapping files for CLM surface dataset (since this is a non-standard grid).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  &gt; cd $CIMEROOT/../components/clm/tools/mkmapdata
  &gt; ./mkmapdata.sh --gridfile &lt;lnd SCRIP grid file&gt; --res &lt;atm resolution name&gt; --gridtype global

These mapping files are then used to generate CLM surface dataset. Below is an example for a current day surface dataset (model year 2000).

::

   &gt; cd $CIMEROOT/../components/clm/tools/mksurfdata_map
   &gt; ./mksurfdata.pl -res usrspec -usr_gname &lt;atm resolution name&gt; -usr_gdate yymmdd -y 2000
</pre></div>
</div>
</li>
<li><p>Create grid file needed for create_newcase.
The next step is to add the necessary new entries in the appropriate <code class="docutils literal notranslate"><span class="pre">config_grids.xml</span></code> file.
You will need to modify <code class="docutils literal notranslate"><span class="pre">$CIMEROOT/config/cesm/config_grids.xml</span></code> or <code class="docutils literal notranslate"><span class="pre">$CIMEROOT/config/e3sm/config_grids.xml</span></code> depending on the value of <code class="docutils literal notranslate"><span class="pre">$CIME_MODEL</span></code>.
You will need to:</p>
<ul class="simple">
<li><p>add a single  <code class="docutils literal notranslate"><span class="pre">&lt;model_grid&gt;</span></code> entry</p></li>
<li><p>add possibly multiple <code class="docutils literal notranslate"><span class="pre">&lt;domain&gt;</span></code> entries for  every new component grid that you have added</p></li>
<li><p>add possibly multiple <code class="docutils literal notranslate"><span class="pre">&lt;gridmap&gt;</span></code> entries for all the new component combinations that require new mapping files</p></li>
</ul>
</li>
<li><p>Test new grid.</p>
<p>Below assume that the new grid is an atmosphere grid.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Test</span> <span class="n">the</span> <span class="n">new</span> <span class="n">grid</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">data</span> <span class="n">components</span><span class="o">.</span>
<span class="p">(</span><span class="n">write</span> <span class="n">an</span> <span class="n">example</span><span class="p">)</span>
<span class="n">Test</span> <span class="n">the</span> <span class="n">new</span> <span class="n">grid</span> <span class="k">with</span> <span class="n">CAM</span><span class="p">(</span><span class="n">newgrid</span><span class="p">),</span> <span class="n">CLM</span><span class="p">(</span><span class="n">newgrid</span><span class="p">),</span> <span class="n">DOCN</span><span class="p">(</span><span class="n">gx1v6</span><span class="p">),</span> <span class="n">DICE</span><span class="p">(</span><span class="n">gx1v6</span><span class="p">)</span>
<span class="p">(</span><span class="n">write</span> <span class="n">an</span> <span class="n">example</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="compsets.html" class="btn btn-neutral float-left" title="3. Component sets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="machine.html" class="btn btn-neutral float-right" title="5. Defining the machine" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, U.S. National Science Foundation and U.S. Department of Energy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
     
<script>var version_json_loc = "../../../versions.json";</script>


</footer>
        </div>
      </div>
    </section>
  </div>
  

  <script type="text/javascript">
    let baseUriRegex = /(.*\/cime)\/.*/g;
    let parsedUri = baseUriRegex.exec(document.baseURI);

    if (parsedUri != null && parsedUri.length == 2) {
      let baseUri = parsedUri[1];

      $.get(`${baseUri}/versions/versions.json`, function(data) {
        let versionElement = $("#versions");

        Object.keys(data).forEach(function(key) {
          let value = data[key];

          let item = `<dd><a href="${baseUri}/versions/${key}/html/">${value}</a></dd>`

          versionElement.append(item);
        });
      });
    }
  </script>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: master
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl id="versions">
        <dt>Versions</dt>
      </dl>
      
      
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>