

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9. Troubleshooting &mdash; CIME cime5.6 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="CIME cime5.6 documentation" href="../index.html"/>
        <link rel="up" title="Case Control System Part 1: Basic Usage" href="index.html"/>
        <link rel="next" title="1. Main Configuration File" href="cime-internals.html"/>
        <link rel="prev" title="8. CIME user config directory" href="cime-config.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> CIME
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>cime5.6</option>
                      
                        
                      
                        
                          <option value="">[placeholder]</option>
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../what_cime/index.html">What is CIME?</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Case Control System Part 1: Basic Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction-and-overview.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="create-a-case.html">2. Creating a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="setting-up-a-case.html">3. Setting up a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="building-a-case.html">4. Building a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="running-a-case.html">5. Running a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloning-a-case.html">6. Cloning a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="cime-change-namelist.html">7. Customizing your input variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="cime-config.html">8. CIME user config directory</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9. Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-case-creation">9.1. Troubleshooting case creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-job-submission">9.2. Troubleshooting job submission</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-runtime-problems">9.3. Troubleshooting runtime problems</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#case-control-system-part-2-configuration-porting-testing-and-use-cases">Case Control System Part 2: Configuration, Porting, Testing and Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_models/index.html">Data Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver_cpl/index.html">Driver/Coupler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build_cpl/index.html">Building a Coupled Model with CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_tools/index.html">Miscellaneous Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary/index.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_user/index.html">User Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xml_files/index.html">XML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CIME_api/modules.html">CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_api/modules.html">Tools</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CIME</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Case Control System Part 1: Basic Usage</a> &raquo;</li>
        
      <li>9. Troubleshooting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/users_guide/troubleshooting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="troubleshooting">
<span id="id1"></span><h1>9. Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="troubleshooting-case-creation">
<h2>9.1. Troubleshooting case creation<a class="headerlink" href="#troubleshooting-case-creation" title="Permalink to this headline">¶</a></h2>
<p>Generally, <a class="reference external" href="../Tools_user/create_newcase.html">create_newcase</a> errors are reported to the terminal and should provide some guidance about what caused them.</p>
<p>If <a class="reference external" href="../Tools_user/create_newcase.html">create_newcase</a> fails on a relatively generic error, first check to make sure the command-line arguments match the interface’s specification. See the help text to review usage.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">create_newcase</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
</div>
<div class="section" id="troubleshooting-job-submission">
<h2>9.2. Troubleshooting job submission<a class="headerlink" href="#troubleshooting-job-submission" title="Permalink to this headline">¶</a></h2>
<p>Most problems associated with submission or launch are site-specific.
The batch and run aspects of the <a class="reference external" href="../Tools_user/case.submit.html">case.submit</a> script are created by parsing the variables in <strong>$CASEROOT/env_batch.xml</strong> file.</p>
<p>Take these steps to check for problems:</p>
<ol class="arabic simple">
<li>Review the batch submission options in <strong>$CASEROOT/env_batch.xml</strong>. Confirm that they are consistent with the site-specific batch environment, and that the queue names, time limits, and hardware processor request make sense and are consistent with the case.</li>
<li>Make sure that <a class="reference external" href="../Tools_user/case.submit.html">case.submit</a> uses the correct batch job tool for submitting the <a class="reference external" href="../Tools_user/case.submit.html">case.submit</a> script. Depending on the batch environment, it might be <strong>bsub</strong>, <strong>qsub</strong> or another command. Also confirm if a redirection “&lt;” character is required. The information for how <strong>case.submit</strong> submits jobs appears at the end of the standard output stream.</li>
</ol>
</div>
<div class="section" id="troubleshooting-runtime-problems">
<h2>9.3. Troubleshooting runtime problems<a class="headerlink" href="#troubleshooting-runtime-problems" title="Permalink to this headline">¶</a></h2>
<p>To see if a run completed successfully, check the last several lines of the <strong>cpl.log</strong> file for a string like <code class="docutils literal notranslate"><span class="pre">SUCCESSFUL</span> <span class="pre">TERMINATION</span></code>. A successful job also usually copies the log files to the <strong>$CASEROOT/logs</strong> directory.</p>
<p>Check these things first when a job fails:</p>
<ul class="simple">
<li>Did the model time out?</li>
<li>Was a disk quota limit hit?</li>
<li>Did a machine go down?</li>
<li>Did a file system become full?</li>
</ul>
<p>If any of those things happened, take appropriate corrective action (see suggestions below) and resubmit the job.</p>
<p>If it is not clear that any of the above caused a case to fail, there are several places to look for error messages.</p>
<ul class="simple">
<li>Check component log files in your run directory (<code class="docutils literal notranslate"><span class="pre">$RUNDIR</span></code>).
This directory is set in the <strong>env_run.xml</strong> file.
Each component writes its own log file, and there should be log files for every component in this format: <strong>cpl.log.yymmdd-hhmmss</strong>.
Check each log file for an error message, especially at or near the end.</li>
<li>Check for a standard out and/or standard error file in <code class="docutils literal notranslate"><span class="pre">$CASEROOT</span></code>.
The standard out/err file often captures a significant amount of extra model output and also often contains significant system output when a job terminates.
Useful error messages sometimes are found well above the bottom of a large standard out/err file. Backtrack from the bottom in search of an error message.</li>
<li>Check for core files in your run directory and review them using an appropriate tool.</li>
<li>Check any automated email from the job about why a job failed. Some sites’ batch schedulers send these.</li>
<li>Check the archive directory: <strong>$DOUT_S_ROOT/$CASE</strong>.   If a case failed, the log files
or data may still have been archived.</li>
</ul>
<p><strong>Common errors</strong></p>
<p>One common error is for a job to time out, which often produces minimal error messages.
Review the daily model date stamps in the <strong>cpl.log</strong> file and the timestamps of files in your run directory to deduce the start and stop time of a run.
If the model was running fine, but the wallclock limit was reached, either reduce the run length or increase the wallclock setting.</p>
<p>If the model hangs and then times out, that usually indicates an MPI or file system problem or possibly a model problem. If you suspect an intermittent system problem, try resubmitting the job. Also send a help request to local site consultants to provide them with feedback about system problems and to get help.</p>
<p>Another error that can cause a timeout is a slow or intermittently slow node.
The <strong>cpl.log</strong> file normally outputs the time used for every model simulation day. To review that data, grep the <strong>cpl.log</strong> file for the string <code class="docutils literal notranslate"><span class="pre">tStamp</span></code> as shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">grep</span> <span class="n">tStamp</span> <span class="n">cpl</span><span class="o">.</span><span class="n">log</span><span class="o">.*</span> <span class="o">|</span> <span class="n">more</span>
</pre></div>
</div>
<p>The output looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tStamp_write</span><span class="p">:</span> <span class="n">model</span> <span class="n">date</span> <span class="o">=</span> <span class="mi">10120</span> <span class="mi">0</span> <span class="n">wall</span> <span class="n">clock</span> <span class="o">=</span> <span class="mi">2009</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">09</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">46</span> <span class="n">avg</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">58.58</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">58.18</span>
<span class="n">tStamp_write</span><span class="p">:</span> <span class="n">model</span> <span class="n">date</span> <span class="o">=</span> <span class="mi">10121</span> <span class="mi">0</span> <span class="n">wall</span> <span class="n">clock</span> <span class="o">=</span> <span class="mi">2009</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">32</span> <span class="n">avg</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">60.10</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">105.90</span>
</pre></div>
</div>
<p>Review the run times at the end of each line for each model day.
The “avg dt =” is  the average time to simulate a model day and “dt = ” is the time needed to simulate the latest model day.</p>
<p>The model date is printed in YYYYMMDD format and the wallclock is the local date and time.
In the example, 10120 is Jan 20, 0001, and the model took 58 seconds to run that day.
The next day, Jan 21, took 105.90 seconds.</p>
<p>A wide variation in the simulation time for typical mid-month model days suggests a system problem. However, there are variations in the cost of the model over time.
For instance, on the last day of every simulated month, the model typically writes netcdf files, which can be a significant intermittent cost.
Also, some model configurations read data mid-month or run physics intermittently at a timestep longer than one day.
In those cases, some variability is expected. The time variation typically is quite erratic and unpredictable if the problem is system performance variability.</p>
<p>Sometimes when a job times out or overflows disk space, the restart files will get mangled.
With the exception of the CAM and CLM history files, all the restart files have consistent sizes.</p>
<p>Compare the restart files against the sizes of a previous restart. If they don’t match, remove them and move the previous restart into place before resubmitting the job.
See <a class="reference external" href="http://esmci.github.io/cime/users_guide/running-a-case.html#restarting-a-run">Restarting a run</a>.</p>
<p>It is not uncommon for nodes to fail on HPC systems or for access to large file systems to hang. Before you file a bug report, make sure a case fails consistently in the same place.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cime-internals.html" class="btn btn-neutral float-right" title="1. Main Configuration File" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cime-config.html" class="btn btn-neutral" title="8. CIME user config directory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, U.S. National Science Foundation and U.S. Department of Energy.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>