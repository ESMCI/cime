<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7. Timers and timing &mdash; CIME master documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=30d551ce"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/pop_ver.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Testing" href="testing.html" />
    <link rel="prev" title="6. Porting and validating CIME on a new platform" href="porting-cime.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CIME
          </a>
              <div class="version">
                master
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../what_cime/index.html">What is CIME?</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Case Control System Part 1: Basic Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#case-control-system-part-2-configuration-porting-testing-and-use-cases">Case Control System Part 2: Configuration, Porting, Testing and Use Cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cime-internals.html">1. Main Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="compsets.html">2. Component sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="grids.html">3. Model grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="machine.html">4. Defining the machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="pes-threads.html">5. Controlling processors and threads</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting-cime.html">6. Porting and validating CIME on a new platform</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">7. Timers and timing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-timing-data">7.1. Model timing data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-timers">7.2. Controlling timers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advice-on-setting-your-wallclock-time">7.3. Advice on setting your wallclock time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">8. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing.html">9. Fortran Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi-instance.html">10. Multi-instance component functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html">11. Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="cime-dir.html">12. Directory content</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../build_cpl/index.html">Building a Coupled Model with CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_tools/index.html">Miscellaneous Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary/index.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_user/index.html">User Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xml_files/index.html">XML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CIME_api/modules.html">CIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools_api/modules.html">Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CIME</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Case Control System Part 1: Basic Usage</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7. </span>Timers and timing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/users_guide/timers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="timers-and-timing">
<span id="timers"></span><h1><span class="section-number">7. </span>Timers and timing<a class="headerlink" href="#timers-and-timing" title="Link to this heading"></a></h1>
<p>CIME includes a copy of the General Purpose Timing Library (GPTL) and timers are placed throughout the CIME driver.  CIME-driven models typically
also have GPTL timers in their code and very detailed timing information can be obtained.</p>
<section id="model-timing-data">
<span id="id1"></span><h2><span class="section-number">7.1. </span>Model timing data<a class="headerlink" href="#model-timing-data" title="Link to this heading"></a></h2>
<p>Every model run produces three types of timing output that you can examine:</p>
<ol class="arabic">
<li><p><strong>$CASEROOT/timing/$model_timing.$CASE.$datestamp</strong></p>
<p>This is the most useful way to quickly determine timing summaries across components
The following describes the most important parts of this timing file:</p>
<p>An example timing file of this type is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">----------------</span> <span class="n">TIMING</span> <span class="n">PROFILE</span> <span class="o">---------------------</span>
<span class="n">Case</span>        <span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">e20</span><span class="o">.</span><span class="n">BHIST</span><span class="o">.</span><span class="n">f09_g17</span><span class="mf">.20</span><span class="n">thC</span><span class="mf">.297_02</span>
<span class="n">LID</span>         <span class="p">:</span> <span class="mf">9459679.</span><span class="n">chadmin1</span><span class="mf">.180517</span><span class="o">-</span><span class="mi">114852</span>
<span class="n">Machine</span>     <span class="p">:</span> <span class="n">cheyenne</span>
<span class="n">Caseroot</span>    <span class="p">:</span> <span class="o">/</span><span class="n">glade</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="n">cesmdata</span><span class="o">/</span><span class="n">cseg</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">cesm2_0</span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">e20</span><span class="o">.</span><span class="n">BHIST</span><span class="o">.</span><span class="n">f09_g17</span><span class="mf">.20</span><span class="n">thC</span><span class="mf">.297_02</span>
<span class="n">Timeroot</span>    <span class="p">:</span> <span class="o">/</span><span class="n">glade</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="n">cesmdata</span><span class="o">/</span><span class="n">cseg</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">cesm2_0</span><span class="o">/</span><span class="n">b</span><span class="o">.</span><span class="n">e20</span><span class="o">.</span><span class="n">BHIST</span><span class="o">.</span><span class="n">f09_g17</span><span class="mf">.20</span><span class="n">thC</span><span class="mf">.297_02</span><span class="o">/</span><span class="n">Tools</span>
<span class="n">User</span>        <span class="p">:</span> <span class="n">hannay</span>
<span class="n">Curr</span> <span class="n">Date</span>   <span class="p">:</span> <span class="n">Thu</span> <span class="n">May</span> <span class="mi">17</span> <span class="mi">12</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mi">27</span> <span class="mi">2018</span>
<span class="n">grid</span>        <span class="p">:</span> <span class="n">a</span><span class="o">%</span><span class="mf">0.9</span><span class="n">x1</span><span class="mf">.25</span><span class="n">_l</span><span class="o">%</span><span class="mf">0.9</span><span class="n">x1</span><span class="mf">.25</span><span class="n">_oi</span><span class="o">%</span><span class="n">gx1v7_r</span><span class="o">%</span><span class="n">r05_g</span><span class="o">%</span><span class="n">gland4_w</span><span class="o">%</span><span class="n">ww3a_m</span><span class="o">%</span><span class="n">gx1v7</span>
<span class="n">compset</span>     <span class="p">:</span> <span class="n">HIST_CAM60_CLM50</span><span class="o">%</span><span class="n">BGC</span><span class="o">-</span><span class="n">CROP_CICE_POP2</span><span class="o">%</span><span class="n">ECO_MOSART_CISM2</span><span class="o">%</span><span class="n">NOEVOLVE_WW3_BGC</span><span class="o">%</span><span class="n">BDRD</span>
<span class="n">run_type</span>    <span class="p">:</span> <span class="n">hybrid</span><span class="p">,</span> <span class="n">continue_run</span> <span class="o">=</span> <span class="n">FALSE</span> <span class="p">(</span><span class="n">inittype</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
<span class="n">stop_option</span> <span class="p">:</span> <span class="n">nyears</span><span class="p">,</span> <span class="n">stop_n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">run_length</span>  <span class="p">:</span> <span class="mi">365</span> <span class="n">days</span> <span class="p">(</span><span class="mf">364.958333333</span> <span class="k">for</span> <span class="n">ocean</span><span class="p">)</span>

<span class="n">component</span>       <span class="n">comp_pes</span>    <span class="n">root_pe</span>   <span class="n">tasks</span>  <span class="n">x</span> <span class="n">threads</span> <span class="n">instances</span> <span class="p">(</span><span class="n">stride</span><span class="p">)</span>
<span class="o">---------</span>        <span class="o">------</span>     <span class="o">-------</span>   <span class="o">------</span>   <span class="o">------</span>  <span class="o">---------</span>  <span class="o">------</span>
<span class="n">cpl</span> <span class="o">=</span> <span class="n">cpl</span>        <span class="mi">3456</span>        <span class="mi">0</span>        <span class="mi">1152</span>   <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">atm</span> <span class="o">=</span> <span class="n">cam</span>        <span class="mi">3456</span>        <span class="mi">0</span>        <span class="mi">1152</span>   <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">lnd</span> <span class="o">=</span> <span class="n">clm</span>        <span class="mi">2592</span>        <span class="mi">0</span>        <span class="mi">864</span>    <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">ice</span> <span class="o">=</span> <span class="n">cice</span>       <span class="mi">864</span>         <span class="mi">864</span>      <span class="mi">288</span>    <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">ocn</span> <span class="o">=</span> <span class="n">pop</span>        <span class="mi">768</span>         <span class="mi">1152</span>     <span class="mi">256</span>    <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">rof</span> <span class="o">=</span> <span class="n">mosart</span>     <span class="mi">2592</span>        <span class="mi">0</span>        <span class="mi">864</span>    <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">glc</span> <span class="o">=</span> <span class="n">cism</span>       <span class="mi">3456</span>        <span class="mi">0</span>        <span class="mi">1152</span>   <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">wav</span> <span class="o">=</span> <span class="n">ww</span>         <span class="mi">96</span>          <span class="mi">1408</span>     <span class="mi">32</span>     <span class="n">x</span> <span class="mi">3</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>
<span class="n">esp</span> <span class="o">=</span> <span class="n">sesp</span>       <span class="mi">1</span>           <span class="mi">0</span>        <span class="mi">1</span>      <span class="n">x</span> <span class="mi">1</span>       <span class="mi">1</span>      <span class="p">(</span><span class="mi">1</span>     <span class="p">)</span>

<span class="n">total</span> <span class="n">pes</span> <span class="n">active</span>           <span class="p">:</span> <span class="mi">12960</span>
<span class="n">mpi</span> <span class="n">tasks</span> <span class="n">per</span> <span class="n">node</span>               <span class="p">:</span> <span class="mi">36</span>
<span class="n">pe</span> <span class="n">count</span> <span class="k">for</span> <span class="n">cost</span> <span class="n">estimate</span> <span class="p">:</span> <span class="mi">4320</span>

<span class="n">Overall</span> <span class="n">Metrics</span><span class="p">:</span>
<span class="n">Model</span> <span class="n">Cost</span><span class="p">:</span>            <span class="mf">3541.30</span>   <span class="n">pe</span><span class="o">-</span><span class="n">hrs</span><span class="o">/</span><span class="n">simulated_year</span>
<span class="n">Model</span> <span class="n">Throughput</span><span class="p">:</span>        <span class="mf">29.28</span>   <span class="n">simulated_years</span><span class="o">/</span><span class="n">day</span>

<span class="n">Init</span> <span class="n">Time</span>   <span class="p">:</span>     <span class="mf">242.045</span> <span class="n">seconds</span>
<span class="n">Run</span> <span class="n">Time</span>    <span class="p">:</span>    <span class="mf">2951.082</span> <span class="n">seconds</span>        <span class="mf">8.085</span> <span class="n">seconds</span><span class="o">/</span><span class="n">day</span>
<span class="n">Final</span> <span class="n">Time</span>  <span class="p">:</span>       <span class="mf">0.008</span> <span class="n">seconds</span>

<span class="n">Actual</span> <span class="n">Ocn</span> <span class="n">Init</span> <span class="n">Wait</span> <span class="n">Time</span>     <span class="p">:</span>     <span class="mf">768.737</span> <span class="n">seconds</span>
<span class="n">Estimated</span> <span class="n">Ocn</span> <span class="n">Init</span> <span class="n">Run</span> <span class="n">Time</span>   <span class="p">:</span>       <span class="mf">0.248</span> <span class="n">seconds</span>
<span class="n">Estimated</span> <span class="n">Run</span> <span class="n">Time</span> <span class="n">Correction</span> <span class="p">:</span>       <span class="mf">0.000</span> <span class="n">seconds</span>
  <span class="p">(</span><span class="n">This</span> <span class="n">correction</span> <span class="n">has</span> <span class="n">been</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ocean</span> <span class="ow">and</span> <span class="n">total</span> <span class="n">run</span> <span class="n">times</span><span class="p">)</span>

<span class="n">Runs</span> <span class="n">Time</span> <span class="ow">in</span> <span class="n">total</span> <span class="n">seconds</span><span class="p">,</span> <span class="n">seconds</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">day</span><span class="p">,</span> <span class="ow">and</span> <span class="n">model</span><span class="o">-</span><span class="n">years</span><span class="o">/</span><span class="n">wall</span><span class="o">-</span><span class="n">day</span>
<span class="n">CPL</span> <span class="n">Run</span> <span class="n">Time</span> <span class="n">represents</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">CPL</span> <span class="n">pes</span> <span class="n">alone</span><span class="p">,</span> <span class="ow">not</span> <span class="n">including</span> <span class="n">time</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">data</span> <span class="n">exchange</span> <span class="k">with</span> <span class="n">other</span> <span class="n">components</span>

<span class="n">TOT</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>    <span class="mf">2951.082</span> <span class="n">seconds</span>        <span class="mf">8.085</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>        <span class="mf">29.28</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">CPL</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>     <span class="mf">248.696</span> <span class="n">seconds</span>        <span class="mf">0.681</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>       <span class="mf">347.41</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">ATM</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>    <span class="mf">2097.788</span> <span class="n">seconds</span>        <span class="mf">5.747</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>        <span class="mf">41.19</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">LND</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>     <span class="mf">545.991</span> <span class="n">seconds</span>        <span class="mf">1.496</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>       <span class="mf">158.24</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">ICE</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>     <span class="mf">389.173</span> <span class="n">seconds</span>        <span class="mf">1.066</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>       <span class="mf">222.01</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">OCN</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>    <span class="mf">2169.399</span> <span class="n">seconds</span>        <span class="mf">5.944</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>        <span class="mf">39.83</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">ROF</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>      <span class="mf">42.241</span> <span class="n">seconds</span>        <span class="mf">0.116</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>      <span class="mf">2045.41</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">GLC</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>       <span class="mf">1.049</span> <span class="n">seconds</span>        <span class="mf">0.003</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>     <span class="mf">82364.16</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">WAV</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>     <span class="mf">517.414</span> <span class="n">seconds</span>        <span class="mf">1.418</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>       <span class="mf">166.98</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">ESP</span> <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>       <span class="mf">0.000</span> <span class="n">seconds</span>        <span class="mf">0.000</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>         <span class="mf">0.00</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>
<span class="n">CPL</span> <span class="n">COMM</span> <span class="n">Time</span><span class="p">:</span>   <span class="mf">2464.660</span> <span class="n">seconds</span>        <span class="mf">6.752</span> <span class="n">seconds</span><span class="o">/</span><span class="n">mday</span>        <span class="mf">35.06</span> <span class="n">myears</span><span class="o">/</span><span class="n">wday</span>

<span class="o">----------------</span> <span class="n">DRIVER</span> <span class="n">TIMING</span> <span class="n">FLOWCHART</span> <span class="o">---------------------</span>
<span class="o">.............</span>
</pre></div>
</div>
<p>TIMING PROFILE is the first section in the timing output. It
summarizes general timing information for the run. The total run
time and cost are given in several metrics to facilitate analysis
and comparisons with other runs. These metrics includ pe-hrs per
simulated year (cost), simulated years per wall day (thoughput),
seconds, and seconds per model day. The total run time for each
component and the time for initialization of the model also are
provided. These times are the aggregate over the total run and do
not take into account any temporal or processor load imbalances.</p>
<p>DRIVER TIMING FLOWCHART is the second section in the timing
output. It provides timing information for the driver in
sequential order and indicates which processors are involved in
the cost. Finally, the timings for the coupler are broken out at
the bottom of the timing output file.</p>
</li>
<li><p><strong>$CASEROOT/timing/$model_timing_stats.$date</strong></p>
<p>Provides an overall detailed timing summary for each component, including the minimum and maximum of all the model timers.</p>
</li>
<li><p><strong>cpl.log.$datestamp</strong></p>
<p>Contains the run time for each model day during the run and is
output during the run. You can search for <code class="docutils literal notranslate"><span class="pre">tStamp</span></code> in the cpl.log
file to see the information, which is useful for tracking down
temporal variability in cost due to inherent model variability or
to hardware. The model daily cost generally is pretty constant
unless I/O is written intermittently, such as at the end of the
month. This file will appear either in <strong>$RUNDIR</strong> or in
<strong>DOUT_S_ROOT/logs</strong> for your run.</p>
</li>
</ol>
<p>The xml variable <code class="docutils literal notranslate"><span class="pre">CHECK_TIMING</span></code>, if set to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> (the default) will produce the timing files in the <strong>$CASEROOT/timing</strong> directory.</p>
</section>
<section id="controlling-timers">
<h2><span class="section-number">7.2. </span>Controlling timers<a class="headerlink" href="#controlling-timers" title="Link to this heading"></a></h2>
<p>User customization of timers is done via the xml variables <code class="docutils literal notranslate"><span class="pre">TIMER_LEVEL</span></code> and <code class="docutils literal notranslate"><span class="pre">TIMER_DETAIL</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TIMER_LEVEL</span></code>:</p>
<p>This is the maximum code stack depth of enabled timers.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">TIMER_DETAIL</span></code>:</p>
<p>This is an integer indicating maximum detail level to profile.  This
xml variable is used to set the namelist variable timing_detail_limit.
This namelist variable is used by perf_mod (in
$CIMEROOT/src/share/timing/perf_mod.F90) to turn timers off and on
depending on calls to the routine t_adj_detailf.  If in the code a
statement appears like t_adj_detailf(+1), then the current timer
detail level is incremented by 1 and compared to the time_detail_limit
obtained from the namelist.  If the limit is exceeded then the timer
is turned off.</p>
</li>
</ul>
<p>Further control of timers is then done via modifications of the <strong>prof_inparm namelists</strong> in the file <strong>drv_in</strong>. This is done
via keyword-value settings in user_nl_cpl. As an example, if you want to set the namelist variable <code class="docutils literal notranslate"><span class="pre">profile_barriers</span></code> to <code class="docutils literal notranslate"><span class="pre">.true.</span></code>,
add the following line in your <strong>$CASEROOT/user_nl_cpl</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">profile_barriers</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="advice-on-setting-your-wallclock-time">
<h2><span class="section-number">7.3. </span>Advice on setting your wallclock time<a class="headerlink" href="#advice-on-setting-your-wallclock-time" title="Link to this heading"></a></h2>
<dl>
<dt>When you look at the <strong>$model_timing.$CASE.$datestamp</strong> file for “Model Throughput”, you will find output like this:</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overall</span> <span class="n">Metrics</span><span class="p">:</span>
<span class="n">Model</span> <span class="n">Cost</span><span class="p">:</span> <span class="mf">327.14</span> <span class="n">pe</span><span class="o">-</span><span class="n">hrs</span><span class="o">/</span><span class="n">simulated_year</span> <span class="p">(</span><span class="n">scale</span><span class="o">=</span> <span class="mf">0.50</span><span class="p">)</span>
<span class="n">Model</span> <span class="n">Throughput</span><span class="p">:</span> <span class="mf">4.70</span> <span class="n">simulated_years</span><span class="o">/</span><span class="n">day</span>
</pre></div>
</div>
</dd>
</dl>
<p>The model throughput is the estimated number of model years that you
can run in a wallclock day. Based on this, you can maximize your queue
limit and change <code class="docutils literal notranslate"><span class="pre">$STOP_OPTION</span></code> and <code class="docutils literal notranslate"><span class="pre">$STOP_N</span></code>.</p>
<p>For example, say a model’s throughput is 4.7 simulated_years/day, and
the maximum runtime limit on your machine is 12 hours. 4.7 model
years/24 hours * 12 hours = 2.35 years. On the massively parallel
computers, there is always some variability in how long it will take
a job to run. On some machines, you may need to leave as much as 20%
buffer time in your run to guarantee that jobs finish reliably before
the time limit. For that reason, set your model to run only one model
year/job. In this example, set your wallclock at 12 hours and invoke
<a class="reference external" href="../Tools_user/xmlchange.html">xmlchange</a>  in <code class="docutils literal notranslate"><span class="pre">CASEROOT</span></code> as shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;./</span><span class="n">xmlchange</span> <span class="n">STOP_OPTION</span><span class="o">=</span><span class="n">nyears</span>
<span class="o">&gt;./</span><span class="n">xmlchange</span> <span class="n">STOP_N</span><span class="o">=</span><span class="mi">1</span>
<span class="o">&gt;./</span><span class="n">xmlchange</span> <span class="n">REST_OPTION</span><span class="o">=</span><span class="n">nyears</span>
<span class="o">&gt;./</span><span class="n">xmlchange</span> <span class="n">REST_N</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="porting-cime.html" class="btn btn-neutral float-left" title="6. Porting and validating CIME on a new platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="testing.html" class="btn btn-neutral float-right" title="8. Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, U.S. National Science Foundation and U.S. Department of Energy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
     
<script>var version_json_loc = "../../../versions.json";</script>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>